var close_container=".close-fileUpload-container";var change_photo="#hh-change-profile-photo";var fileInput="#fileUpload-file";var errorMessage="#fuErrorMessageText";var jcrop_api;var img_canvas="#fileUpload-canvas";var preview="#fileUpload-preview";var selectMode=".fileUpload-select";var previewMode=".fileUpload-preview";var errorMode=".fileUpload-error";var form="#fileUpload-control";var uploading=false;jQuery(document).ready(function(e){function t(t){e(selectMode).hide();e(errorMessage).html(t);e(errorMode).fadeIn()}function n(){}function r(t){var n=e(fileInput);n.attr("data-x1",t.x);n.attr("data-y1",t.y);n.attr("data-x2",t.x2);n.attr("data-y2",t.y2);n.attr("data-w",t.w);n.attr("data-h",t.h);n.attr("data-cw",e(img_canvas).width());n.attr("data-ch",e(img_canvas).height())}e(document).on("click",close_container,function(){location.reload()});e(document).on("click",change_photo,function(){e("#fileUpload-container").show();e(".edit-field").addClass("disabled")});e(document).on("change",fileInput,function(){var n=this.files[0];var i=["jpeg","jpg","png","gif"];var s=n.name.split(".").pop().toLowerCase();if(i.indexOf(s)>-1){if(n.size<6291456){var o=new FileReader;o.readAsDataURL(document.getElementById("fileUpload-file").files[0]);o.onload=function(t){e(selectMode).hide();e(previewMode).show();var n=e(preview);n.css("visibility","visible");n.attr("src",t.target.result).fadeIn();n.show();var i=e(img_canvas);n.Jcrop({setSelect:[100,100,400,400],minSize:[150,150],aspectRatio:1,boxWidth:i.width(),onSelect:r},function(){jcrop_api=this;i.width(jcrop_api.getWidgetSize()[0]);i.height(jcrop_api.getWidgetSize()[1])})}}else{t('<span style="font-weight:bold;color:#FF0000;">Too big!</span><br/> (Filesize must be less than 6 Megabytes)')}}else{t('<span style="font-weight:bold;color:#FF0000;">Invalid Filetype!</span><br/> (Only jpeg, jpg, png, gif are supported)')}});e(document).on("submit",form,function(t){t.preventDefault();var n=e("#fuProcessContainer");var r=e("#fuProcessPercent");var i=e("#fuProcessStatus");var s=e("#fuProcessImage");nonce=e(this).attr("data-nonce");e("body").css("cursor","wait");e(selectMode).hide();e(previewMode).hide();e(preview).hide();e(".jcrop-holder").hide();e("#fileUpload-file").hide();n.show();r.html("0%").show();i.html("<b>Please Wait...</b>");e(this).ajaxForm({type:"post",dataType:"html",url:_hh_ajax_fileUploader.ajaxurl,data:{action:"hh_save_profile_pic",nonce:nonce,x1:e(fileInput).attr("data-x1"),y1:e(fileInput).attr("data-y1"),x2:e(fileInput).attr("data-x2"),y2:e(fileInput).attr("data-y2"),w:e(fileInput).attr("data-w"),h:e(fileInput).attr("data-h"),cw:e(fileInput).attr("data-cw"),ch:e(fileInput).attr("data-ch")},async:true,beforeSend:function(){uploading=true;r.html("1%");i.html("<b>Connecting...</b>")},uploadProgress:function(e,t,n,o){var u=o+"%";r.html(u);if(u==="100%"){r.hide();s.show();i.html("<b>Processing...</b>")}else{i.html("<b>Uploading...</b>")}},complete:function(t){e(close_container).trigger("click")}});if(uploading===false)e(form).submit()})})
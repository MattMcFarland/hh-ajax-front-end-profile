var close_container=".close-fileUpload-container";var change_photo="#hh-change-profile-photo";var fileInput="#fileUpload-file";var errorMessage="#fileUpload-errorMessage";var jcrop_api;var img_canvas="#fileUpload-canvas";var preview="#fileUpload-preview";var selectMode=".fileUpload-select";var previewMode=".fileUpload-preview";var form="#fileUpload-control";var uploading=false;jQuery(document).ready(function(e){function t(t){var n=e(fileInput);n.attr("data-x1",t.x);n.attr("data-y1",t.y);n.attr("data-x2",t.x2);n.attr("data-y2",t.y2);n.attr("data-w",t.w);n.attr("data-h",t.h);n.attr("data-cw",e(img_canvas).width());n.attr("data-ch",e(img_canvas).height())}e(document).on("click",close_container,function(){location.reload()});e(document).on("click",change_photo,function(){e("#fileUpload-container").show();e(".edit-field").addClass("disabled")});e(document).on("change",fileInput,function(){var n=this.files[0];var r=["jpeg","jpg","png","gif"];var i=n.name.split(".").pop().toLowerCase();if(r.indexOf(i)>-1){if(n.size<6291456){var s=new FileReader;s.readAsDataURL(document.getElementById("fileUpload-file").files[0]);s.onload=function(n){e(selectMode).hide();e(previewMode).show();var r=e(preview);r.removeAttr("style");r.css("visibility","visible");r.attr("src",n.target.result).fadeIn();var i=e(img_canvas);r.Jcrop({setSelect:[100,100,400,400],minSize:[150,150],aspectRatio:1,boxWidth:i.width(),onSelect:t},function(){jcrop_api=this;i.width(jcrop_api.getWidgetSize()[0]);i.height(jcrop_api.getWidgetSize()[1])})}}else{e(errorMessage).html('<span style="font-weight:bold;color:#FF0000;">Too big!</span><br/> (Filesize must be less than 6 Megabytes)').fadeIn()}}else{e(errorMessage).html('<span style="font-weight:bold;color:#FF0000;">Invalid Filetype!</span><br/> (Only jpeg, jpg, png, gif are supported)').fadeIn()}});e(document).on("submit",form,function(t){t.preventDefault();var n=e("#upload_percent");var r=e("#upload_status");var i=e("#upload_processing");var s=e(".fileUpload-process");nonce=e(this).attr("data-nonce");e("body").css("cursor","wait");e(this).ajaxForm({type:"post",dataType:"html",url:_hh_ajax_fileUploader.ajaxurl,data:{action:"hh_save_profile_pic",nonce:nonce,x1:e(fileInput).attr("data-x1"),y1:e(fileInput).attr("data-y1"),x2:e(fileInput).attr("data-x2"),y2:e(fileInput).attr("data-y2"),w:e(fileInput).attr("data-w"),h:e(fileInput).attr("data-h"),cw:e(fileInput).attr("data-cw"),ch:e(fileInput).attr("data-ch")},async:true,beforeSend:function(){uploading=true;e(selectMode).hide();e(previewMode).hide();s.show();n.html("0%").show();r.html("<b>Connecting...</b>")},uploadProgress:function(t,i,s,o){var u=o+"%";n.html(u);if(u==="100%"){n.hide();e("#upload_processing").show();r.html("<b>Processing...</b>");e("#hh_upload_progress").hide()}else{r.html("<b>Uploading...</b>")}},complete:function(t){e(close_container).trigger("click")}});if(uploading===false)e(form).submit()})})